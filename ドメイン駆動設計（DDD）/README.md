# ドメイン駆動設計（DDD: Domain-Driven Design）詳細まとめ

---

## 1. DDDとは

**ドメイン駆動設計（Domain-Driven Design, DDD）** は、複雑な業務システム開発においてドメイン（業務領域）を中心に据え、ドメインの知識やビジネスルールをコードに反映しながら設計・実装を進める手法・思想です。

エリック・エヴァンス（Eric Evans）が2003年に著書『Domain-Driven Design: Tackling Complexity in the Heart of Software』で提唱し、特に複雑なビジネスロジックを扱うソフトウェアで有効とされています。

---

## 2. DDDの目的

- **業務知識の抽出と共有**  
  ドメインエキスパートと開発者間で共通言語（ユビキタス言語）を作り、認識のズレを減らす。  
- **複雑な業務ルールの明確化**  
  ビジネスロジックを適切に分離・構造化し、理解・保守しやすくする。  
- **柔軟な設計と拡張性**  
  業務の変化に対応しやすい設計を目指す。

---

## 3. DDDの基本概念と用語

### 3.1 ユビキタス言語（Ubiquitous Language）

- ドメインエキスパートと開発者が共通して使う言葉や用語。  
- ソースコード、ドキュメント、会話すべてで一貫して使用する。

### 3.2 バウンデッドコンテキスト（Bounded Context）

- ドメインモデルが有効に機能する「境界」や「範囲」。  
- 同じ用語でもコンテキストが違うと意味が異なることがあるため、境界を明確に区切る。  

### 3.3 ドメインモデル（Domain Model）

- 業務知識をオブジェクトモデルとして表現したもの。  
- エンティティ、値オブジェクト、アグリゲートなどで構成される。

### 3.4 エンティティ（Entity）

- 識別子を持ち、ライフサイクルを通じて同一性が保証されるオブジェクト。  
- 状態や属性を持ち、振る舞いを持つ。

### 3.5 値オブジェクト（Value Object）

- 識別子を持たず、属性の集合として定義されるオブジェクト。  
- 不変（Immutable）で、値の等価性で比較される。

### 3.6 アグリゲート（Aggregate）

- 一貫性を保つべきエンティティと値オブジェクトの集まり。  
- アグリゲートルート（Root）を通じて外部とやり取りを行う。

### 3.7 リポジトリ（Repository）

- 永続化の抽象化。アグリゲートの取得・保存を担当。  
- ドメインモデルを意識したインターフェースを提供。

### 3.8 ドメインサービス（Domain Service）

- エンティティや値オブジェクトの責任に属さない複雑なドメインロジックを担当。

### 3.9 アプリケーションサービス（Application Service）

- ユースケースの調整役。複数のドメインモデルやリポジトリを組み合わせ、トランザクション管理も行う。

### 3.10 ドメインイベント（Domain Event）

- ドメイン内で起きた重要な事象を表現し、他のコンポーネントへ通知する仕組み。

---

## 4. DDDの設計プロセス

1. **ドメイン理解**  
   - ドメインエキスパートとの対話で業務を深く理解し、ユビキタス言語を形成。  
2. **バウンデッドコンテキストの定義**  
   - システムを複数のコンテキストに分割し、それぞれ独立したドメインモデルを作る。  
3. **ドメインモデル設計**  
   - エンティティ、値オブジェクト、アグリゲートの設計。  
4. **インフラ・永続化の抽象化**  
   - リポジトリパターンで永続化を抽象化。  
5. **ドメインサービスの設計**  
   - エンティティに属さないロジックを分離。  
6. **アプリケーションサービスの設計**  
   - ユースケースごとの処理フローとトランザクション管理。  
7. **イベント駆動設計の適用（必要に応じて）**  
   - ドメインイベントを用いて疎結合の仕組みを構築。

---

## 5. DDDのメリット

- 複雑なビジネスルールを自然にコードに反映できる。  
- 開発者とドメインエキスパート間のコミュニケーションが円滑になる。  
- モデルの一貫性を保ちつつ拡張・保守が容易になる。  
- コンテキストを分割しやすいため、チーム分割やマイクロサービス化と親和性が高い。

---

## 6. DDDの課題・注意点

- 初期学習コストが高い。  
- ドメイン理解のための継続的なコミュニケーションが必要。  
- 過剰設計になりやすく、小規模・単純システムには向かない場合も。  
- バウンデッドコンテキストの境界設定が難しい。  
- インフラ実装との整合性を保つため、適切な抽象化が求められる。

---

## 7. まとめ

DDDは「ドメインの理解を軸に設計を行い、業務の複雑性をモデルに閉じ込めて扱う」強力な設計思想です。  
適用にはドメインエキスパートとの連携や設計スキルが不可欠ですが、正しく運用すれば複雑なシステムの保守性・拡張性を大きく向上させます。

---